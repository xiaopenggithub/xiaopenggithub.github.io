name: Deploy VitePress to GitHub Pages

# 触发条件：推送到 master 分支
on:
  push:
    branches: [master]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # 拉取所有历史提交，支持最后更新时间等功能

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20 # 建议使用 Node 18+/20+，兼容 VitePress 2.x
          cache: 'npm' # 缓存 npm 依赖，加速构建

      - name: Install Dependencies
        run: npm install # 你的项目仅依赖 vitepress，此步骤会安装它

      - name: Build VitePress
        run: npm run docs:build # 对应 package.json 中的脚本

      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./docs/.vitepress/dist # VitePress 2.x 构建输出目录（默认）
          publish_branch: gh-pages # 部署到 gh-pages 分支（自动创建）